(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{350:function(s,a,n){"use strict";n.r(a);var e=n(4),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("在手邊的 Proxmox 上使用了一年多的時間，最初是使用一顆 2TB 的 SSD 硬碟，但隨著時間推移，硬碟的容量已經不足以應付需求。為了解決這個問題，決定購買一顆 4TB 的 SSD 來替換。然而，為了節省時間和方便起見，希望能夠直接將舊硬碟的內容遷移到新硬碟上，而不必重新安裝 Proxmox 系統，也不需要搬遷虛擬機。因此，進行了一些研究和操作來實現這個目標，這裡記錄下相關的步驟和方法。")]),s._v(" "),n("h2",{attrs:{id:"硬碟內容搬遷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#硬碟內容搬遷"}},[s._v("#")]),s._v(" "),n("strong",[s._v("硬碟內容搬遷")])]),s._v(" "),n("p",[s._v("首先，我們需要將原始硬碟內的資料搬移到新的硬碟上。我們可以使用 "),n("strong",[n("code",[s._v("dd")])]),s._v(" 命令直接將硬碟內容完全複製過去。這可以在 Proxmox 的 Shell 中執行，無需使用額外的 USB 開機碟操作。儘管這樣做可能會複製 swap 等內容，但重開機後不會影響系統運作。")]),s._v(" "),n("p",[s._v("請先使用 "),n("strong",[n("code",[s._v("lsblk")])]),s._v(" 命令找到原始硬碟和目標硬碟：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk")]),s._v("\nNAME                          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nnvme0n1                       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n├─nvme0n1p1                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 1007K  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n├─nvme0n1p2                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  512M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot/efi\n└─nvme0n1p3                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":3    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n  ├─pve-swap                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SWAP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  ├─pve-root                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   96G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  /\n  ├─pve-data_tmeta            "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │ └─pve-data-tpool          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":4    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │   ├─pve-data              "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":5    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" lvm\n  │   ├─pve-vm--100--disk--0  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":6    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nnvme1n1                       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":4    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".6T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("從上述輸出中，我們可以很容易地辨識出 "),n("strong",[n("code",[s._v("nvme0n1")])]),s._v(" 為原始硬碟，"),n("strong",[n("code",[s._v("nvme1n1")])]),s._v(" 為新的硬碟。")]),s._v(" "),n("p",[s._v("接下來，使用 "),n("strong",[n("code",[s._v("dd")])]),s._v(" 命令進行硬碟內容的複製。為了在處理過程中顯示進度，我們加上 "),n("strong",[n("code",[s._v("status=progress")])]),s._v(" 選項。這樣在複製 2TB 資料時，我們可以知道進度，而不會等太久不知道是不是當掉了 (搬了超過半小時)。"),n("strong",[n("code",[s._v("bs")])]),s._v(" 參數代表 "),n("strong",[n("code",[s._v("dd")])]),s._v(" 一次搬動的資料塊大小，預設值是 512bytes，但這可能會導致速度變慢，因此我們可以選擇較大的值，例如 "),n("strong",[n("code",[s._v("bs=2G")])]),s._v("。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/nvme0n1 of=/dev/nvme1n1 status=progress bs=2G")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("完成後，關機並將舊的硬碟移除，用新的硬碟開機。")]),s._v(" "),n("h2",{attrs:{id:"調整硬碟分割區大小"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#調整硬碟分割區大小"}},[s._v("#")]),s._v(" 調整硬碟分割區大小")]),s._v(" "),n("p",[s._v("理論上，重開機後，應該可以正常進入系統，但從 Proxmox 的 Web GUI 可能會發現存儲空間的大小沒有變化。這是因為雖然資料已經完全複製到容量更大的硬碟，但系統設定仍然只認識原本的硬碟大小。因此，接下來我們需要調整分割區和 LVM 的配置，讓 Proxmox 能夠使用新的空間。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk")]),s._v("\nNAME                          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nnvme0n1                       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".6T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n├─nvme0n1p1                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 1007K  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n├─nvme0n1p2                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  512M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot/efi\n└─nvme0n1p3                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":3    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n  ├─pve-swap                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SWAP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  ├─pve-root                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   96G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  /\n  ├─pve-data_tmeta            "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │ └─pve-data-tpool          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":4    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │   ├─pve-data              "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":5    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" lvm\n  │   ├─pve-vm--100--disk--0  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":6    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("透過  "),n("code",[s._v("lsblk")]),s._v(" ，可以看到硬碟的大小為 3.6T。由於 pve 的資料都放在 nvem0n1p3 這個分割區下面，所以我們要先調整分割區的大小。")]),s._v(" "),n("p",[s._v("這邊我們使用  "),n("code",[s._v("growpart")]),s._v("  這個工具來調整分割區大小。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" cloud-guest-utils\ngrowpart /dev/nvme0n1 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[n("code",[s._v("growpart")])]),s._v(" 的第一個參數是要調整的硬碟，第二個參數是第幾個分割區。"),n("strong",[n("code",[s._v("growpart")])]),s._v(" 預設會將硬碟的剩餘未分配空間都分配給分割區，因此不需要指定大小。如果你擔心出問題，可以先加上 "),n("strong",[n("code",[s._v("-N")])]),s._v(" 選項查看分配的結果是否符合預期。")]),s._v(" "),n("p",[s._v("分配完成後，再次使用 "),n("strong",[n("code",[s._v("lsblk")])]),s._v(" 命令來確認。現在，"),n("strong",[n("code",[s._v("nvme0n1p3")])]),s._v(" 分割區的大小應該已經變成 3.6T 了：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk")]),s._v("\nNAME                          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nnvme0n1                       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".6T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n├─nvme0n1p1                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 1007K  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n├─nvme0n1p2                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  512M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot/efi\n└─nvme0n1p3                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":3    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".6T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n  ├─pve-swap                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":0    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SWAP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  ├─pve-root                  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":1    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   96G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  /\n  ├─pve-data_tmeta            "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":2    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │ └─pve-data-tpool          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":4    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n  │   ├─pve-data              "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":5    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" lvm\n  │   ├─pve-vm--100--disk--0  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":6    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1T  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("但是從 Proxmox 的 Web GUI，你可能會發現存儲空間大小還是沒有改變。這是因為 Proxmox 在 partition 上透過 LVM 做了一層分割，所以我們需要調整 LVM 的大小。")]),s._v(" "),n("h2",{attrs:{id:"調整-lvm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#調整-lvm"}},[s._v("#")]),s._v(" 調整 LVM")]),s._v(" "),n("p",[s._v("首先，我們要調整硬碟分割區對應的 PV（物理卷）大小：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvs")]),s._v("\nPV             VG  Fmt  Attr PSize  PFree\n/dev/nvme0n1p3 pve lvm2 a--  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".74t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".2t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("使用 "),n("strong",[n("code",[s._v("pvs")])]),s._v(" 命令可以查看 PV 的資訊。")]),s._v(" "),n("p",[s._v("接下來，使用 "),n("strong",[n("code",[s._v("pvresize")])]),s._v(" 命令將分割區剩餘的所有空間都加入到 PV 內：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("pvresize /dev/nvme0n1p3\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("這樣就能將分割區未使用的空間加入到 PV，無需進行其他配置。")]),s._v(" "),n("p",[s._v("再次執行 "),n("strong",[n("code",[s._v("pvs")])]),s._v(" 命令，現在你應該會看到 PV 的大小已經增加了：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvs")]),s._v("\nPV             VG  Fmt  Attr PSize  PFree\n/dev/nvme0n1p3 pve lvm2 a--  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".64t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".84t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("最後，我們需要調整 storage 對應的 LV（邏輯卷）的大小。首先，使用 "),n("strong",[n("code",[s._v("lvs")])]),s._v(" 命令來查看 LV 的資訊")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvs")]),s._v("\nLV             VG  Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\ndata           pve twi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".67t             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("73.80")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.82")]),s._v("\nroot           pve -wi-ao----  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),s._v(".00g\nswap           pve -wi-ao----   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".00g\nvm-100-disk-0  pve Vwi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".00t data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("57.73")]),s._v("\nvm-100-disk-1  pve Vwi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.06")]),s._v("\nvm-101-disk-0  pve Vwi-a-tz-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(".00g data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("71.78")]),s._v("\nvm-102-disk-0  pve Vwi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.06")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("從上述輸出中，可以看到所有 VM 的硬碟都掛載在 "),n("strong",[n("code",[s._v("pve/data")])]),s._v(" 這個 pool 下面。因此，我們需要調整的是 "),n("strong",[n("code",[s._v("pve/data")])]),s._v(" 的大小。")]),s._v(" "),n("p",[s._v("使用 "),n("strong",[n("code",[s._v("lvresize")])]),s._v(" 命令來調整 LV 分配的空間， "),n("strong",[n("code",[s._v("-l")])]),s._v(" 表示擴大， "),n("strong",[n("code",[s._v("+100%FREE")])]),s._v(" 表示將所有閒置空間分配給該 LV，最後指定 "),n("strong",[n("code",[s._v("pve/data")])]),s._v("：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("lvresize "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" +100%FREE pve/data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("執行完後再次使用 "),n("strong",[n("code",[s._v("lvs")])]),s._v(" 命令確認，現在 "),n("strong",[n("code",[s._v("data")])]),s._v(" 的大小應該已經變大了：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvs")]),s._v("\nlvs\nLV             VG  Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\ndata           pve twi-aotz--  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".51t             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.16")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.86")]),s._v("\nroot           pve -wi-ao----  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),s._v(".00g\nswap           pve -wi-ao----   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".00g\nvm-100-disk-0  pve Vwi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".00t data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("57.73")]),s._v("\nvm-100-disk-1  pve Vwi-aotz--   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m data        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.06")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("現在，從 Proxmox Web GUI，你也應該可以看到存儲空間大小已成功調整。")])])}),[],!1,null,null,null);a.default=t.exports}}]);